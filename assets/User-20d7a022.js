import{aO as f,b as k,c as E,o as _,e as w,f as M,g as o,w as a,h as e,aj as z,ak as G,i as c,t as p,q as B,x as J,F as K,s as Q,v as X,aP as v,E as Y,j as Z,A as ee,B as te}from"./index-e0dafb85.js";import{E as oe}from"./el-dialog-75a77bcb.js";import{E as le,a as ae}from"./el-form-item-01002221.js";import{u as se}from"./use-table-handlers-14b38a89.js";const ne=s=>f({url:"sys/user/listPage",method:"get",data:s}),re=s=>f({url:"sys/user/save",method:"post",data:s}),de=s=>{const{id:d}=s;return delete s.id,f({url:`sys/user/update/${d}`,method:"post",data:s})},ie=s=>{const{id:d}=s;return delete s.id,f({url:`sys/user/password/${d}`,method:"get",data:s})},me=s=>f({url:"sys/user/delete",method:"post",data:s}),ue={class:"main-body"},ce={class:"toolbar"},ge={__name:"User",setup(s){const d=k({name:""}),i=k({id:"",name:"",roleId:""}),{t,tableRef:C,dialogVisible:h,isEdit:g,formLoading:$,formRef:x,doSearch:I,doAdd:R,doEdit:S,doSubmit:P,doRemove:W,doClose:b}=se(i),q=[{type:"edit",show:l=>l.createdBy!=="system"},{type:"delete",show:l=>l.createdBy!=="system"}],D=E(()=>[{type:"selection",selectable:N},{prop:"id",label:t("thead.ID"),minWidth:50},{prop:"name",label:t("thead.username"),minWidth:120},{prop:"roleName",label:t("thead.group"),minWidth:120},{prop:"createdBy",label:t("thead.createdBy"),minWidth:120},{prop:"ip",label:t("thead.latestIp"),minWidth:100},{prop:"visitTime",label:t("thead.latestVisit"),minWidth:120}]),H=E(()=>({name:[{required:!0,message:t("form.usernameHolder"),trigger:["blur","change"]}],roleId:[{required:!0,message:t("form.roleRequired"),trigger:["blur","change"]}]}));function N(l){return l.createdBy!=="system"}function T(l,r){W(me,l,r)}function U(){P({save:re,update:de},l=>{g.value||v.alert(`${t("tips.success")}${t("form.username")}: ${l.data.name},${t("form.password")}: ${l.data.password}`,t("tips.title"),{confirmButtonText:t("action.confirm")})})}function F(){ie({...i}).then(l=>{console.log(l),v.alert(`${t("tips.success")}${t("form.username")}: ${l.data.name},${t("form.password")}: ${l.data.password}`,t("tips.title"),{confirmButtonText:t("action.confirm")})})}return(l,r)=>{const y=Y,m=ae,u=Z,V=le,j=G,A=ee,L=te,O=oe;return _(),w("div",ue,[M("div",ce,[o(V,{model:e(d),inline:!0},{default:a(()=>[o(m,null,{default:a(()=>[o(y,{modelValue:e(d).name,"onUpdate:modelValue":r[0]||(r[0]=n=>e(d).name=n),placeholder:e(t)("thead.username")},null,8,["modelValue","placeholder"])]),_:1}),o(m,null,{default:a(()=>[o(u,{type:"primary",icon:"search",onClick:e(I)},{default:a(()=>[c(p(e(t)("action.search")),1)]),_:1},8,["onClick"])]),_:1}),o(m,null,{default:a(()=>[o(u,{type:"primary",icon:"plus",onClick:e(R)},{default:a(()=>[c(p(e(t)("action.add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),o(j,{ref_key:"tableRef",ref:C,"get-page":e(ne),filters:e(d),columns:e(D),operations:q,onHandleEdit:e(S),onHandleDelete:T},null,8,["get-page","filters","columns","onHandleEdit"]),o(O,{title:e(g)?e(t)("action.edit"):e(t)("action.add"),modelValue:e(h),"onUpdate:modelValue":r[3]||(r[3]=n=>z(h)?h.value=n:null),draggable:"",width:"40%","close-on-click-modal":!1,onClose:e(b)},{footer:a(()=>[o(u,{onClick:e(b)},{default:a(()=>[c(p(e(t)("action.cancel")),1)]),_:1},8,["onClick"]),e(g)?(_(),B(u,{key:0,type:"primary",onClick:F},{default:a(()=>[c(p(e(t)("form.resetPassword")),1)]),_:1})):J("",!0),o(u,{type:"primary",onClick:U,loading:e($)},{default:a(()=>[c(p(e(t)("action.submit")),1)]),_:1},8,["loading"])]),default:a(()=>[o(V,{ref_key:"formRef",ref:x,model:e(i),"label-width":"80px",rules:e(H),"label-position":"right"},{default:a(()=>[o(m,{label:e(t)("form.username"),prop:"name"},{default:a(()=>[o(y,{modelValue:e(i).name,"onUpdate:modelValue":r[1]||(r[1]=n=>e(i).name=n)},null,8,["modelValue"])]),_:1},8,["label"]),o(m,{label:e(t)("form.group"),prop:"roleId"},{default:a(()=>[o(L,{modelValue:e(i).roleId,"onUpdate:modelValue":r[2]||(r[2]=n=>e(i).roleId=n),placeholder:e(t)("form.choose"),style:{width:"100%"}},{default:a(()=>[(_(!0),w(K,null,Q(e(X),n=>(_(),B(A,{key:n.name,label:n.label,value:n.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}};export{ge as default};
