import{aO as h,r as z,a as I,b as T,bg as w,m as V,h as a,o as m,e as v,f as o,g as d,w as _,F as q,s as F,t as r,z as f,j as U,bh as j,i as y,aP as D,$ as L,bi as O}from"./index-e0dafb85.js";const G=e=>{const s=e.type;return delete e.type,h({url:`/message/list/${s}`,method:"get",data:e})},H=e=>{const{id:s,type:t}=e;return delete e.id,delete e.type,h({url:`/message/read/${t}/${s}`,method:"post",data:e})},J=e=>{const s=e.type;return delete e.type,h({url:`/message/readAll/${s}`,method:"post",data:e})},K=e=>{const{id:s,type:t}=e;return delete e.id,delete e.type,h({url:`/message/${t}/${s}`,method:"delete",data:e})};const Q={key:0},W={class:"txt-r"},X={class:"events"},Y={class:"label"},Z={class:"content"},ee={class:"summary"},te={class:"date"},se={class:"extra text"},ne={class:"actions"},oe=o("i",{class:"el-icon-edit"},null,-1),ae=o("i",{class:"el-icon-delete"},null,-1),ce={class:"flex-center"},le={key:1},ie={class:"nodata txt-c"},re={__name:"MessageItem",props:{type:String},setup(e){const s=z([]),{t}=I(),C=e,l=T({pageNum:1,pageSize:20}),x=z(0),g=w(C,"type"),p=()=>{const{pageNum:c,pageSize:i}=l;G({type:g.value,pageNum:c,pageSize:i}).then(u=>{s.value=u.data.content||[],x.value=u.data.totalSize||0}).catch(()=>{s.value=[]})},k=c=>{H({type:g.value,id:c}).then(()=>{f.success(t("tips.success")),p()})},S=()=>{J({type:g.value}).then(()=>{f.success(t("tips.success")),p()})},b=c=>{D.confirm(t("tips.deleteConfirm"),t("tips.deleteTitle"),{confirmButtonText:t("action.confirm"),cancelButtonText:t("action.cancel"),type:"warning",draggable:!0}).then(()=>{K({type:g.value,id:c}).then(()=>{f.success(t("tips.success")),p()})})};function $(c){l.pageSize=c,l.pageNum=1,p()}function N(c){l.pageNum=c,p()}return p(),(c,i)=>{const u=U,B=V("comment"),M=L,E=O,P=j;return a(s).length?(m(),v("div",Q,[o("div",W,[d(u,{plain:"",type:"primary",onClick:i[0]||(i[0]=n=>S())},{default:_(()=>[y(r(a(t)("action.markedAllRead")),1)]),_:1})]),o("div",X,[(m(!0),v(q,null,F(a(s),(n,R)=>(m(),v("div",{class:"event",key:R},[o("div",Y,[d(E,{"is-dot":!n.isRead},{default:_(()=>[d(M,null,{default:_(()=>[d(B)]),_:1})]),_:2},1032,["is-dot"])]),o("div",Z,[o("div",ee,[y(r(n.title)+" ",1),o("div",te,r(n.date),1)]),o("div",se,r(n.content),1),o("div",ne,[d(u,{type:"text",disabled:n.isRead,class:"action a-read",onClick:A=>k(n.id)},{default:_(()=>[oe,y(" "+r(a(t)("action.markedRead")),1)]),_:2},1032,["disabled","onClick"]),d(u,{type:"text",class:"action a-delete",onClick:A=>b(n.id)},{default:_(()=>[ae,y(" "+r(a(t)("action.delete")),1)]),_:2},1032,["onClick"])])])]))),128))]),o("div",ce,[d(P,{currentPage:a(l).pageNum,"onUpdate:currentPage":i[1]||(i[1]=n=>a(l).pageNum=n),"page-size":a(l).pageSize,"onUpdate:pageSize":i[2]||(i[2]=n=>a(l).pageSize=n),total:a(x)||0,layout:"prev, pager, next",onSizeChange:$,onCurrentChange:N},null,8,["currentPage","page-size","total"])])])):(m(),v("div",le,[o("div",ie,r(a(t)("nodata")),1)]))}}};export{re as default};
