import{am as ne,I as ce,an as fe,ab as E,ao as de,ap as X,aq as $,a8 as M,L as me,ar as be,P as ye,r as ee,b as te,as as ve,c as x,a9 as J,at as _e,au as Ne,n as Ve,Y as he,Z as ge,o as _,e as z,af as oe,h as e,S as ae,al as K,g as r,w as m,q as k,av as Ee,aw as Ie,$ as re,x as O,ax as we,a7 as ke,ay as Q,E as pe,U as Se,O as Ce,aa as Pe,az as ue,ah as Te,f as se,aj as Ae,aA as Fe,aB as Re,ak as De,i as q,t as L,F as xe,s as Be,j as Ue}from"./index-e0dafb85.js";import{E as qe}from"./el-dialog-75a77bcb.js";import{a as Le,b as Me,E as Ke}from"./el-radio-67ddd841.js";import{E as $e,a as ze}from"./el-form-item-01002221.js";import{r as Oe,l as Ge,a as He,s as Ye,u as je}from"./app-resource-e8467381.js";import{u as We}from"./use-table-handlers-14b38a89.js";const Ze=100,Je=600,ie={beforeMount(s,I){const p=I.value,{interval:t=Ze,delay:n=Je}=ne(p)?{}:p;let b,v;const i=()=>ne(p)?p():p.handler(),h=()=>{v&&(clearTimeout(v),v=void 0),b&&(clearInterval(b),b=void 0)};s.addEventListener("mousedown",C=>{C.button===0&&(h(),i(),document.addEventListener("mouseup",()=>h(),{once:!0}),v=setTimeout(()=>{b=setInterval(()=>{i()},t)},n))})}},Qe=ce({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:fe,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:s=>s===null||E(s)||["min","max"].includes(s),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:s=>s>=0&&s===Number.parseInt(`${s}`,10)},validateEvent:{type:Boolean,default:!0}}),Xe={[de]:(s,I)=>I!==s,blur:s=>s instanceof FocusEvent,focus:s=>s instanceof FocusEvent,[X]:s=>E(s)||$(s),[M]:s=>E(s)||$(s)},el=["aria-label","onKeydown"],ll=["aria-label","onKeydown"],al=me({name:"ElInputNumber"}),tl=me({...al,props:Qe,emits:Xe,setup(s,{expose:I,emit:p}){const t=s,{t:n}=be(),b=ye("input-number"),v=ee(),i=te({currentValue:t.modelValue,userInput:null}),{formItem:h}=ve(),C=x(()=>E(t.modelValue)&&t.modelValue<=t.min),G=x(()=>E(t.modelValue)&&t.modelValue>=t.max),le=x(()=>{const l=Y(t.step);return J(t.precision)?Math.max(Y(t.modelValue),l):(l>t.precision,t.precision)}),B=x(()=>t.controls&&t.controlsPosition==="right"),H=_e(),S=Ne(),P=x(()=>{if(i.userInput!==null)return i.userInput;let l=i.currentValue;if($(l))return"";if(E(l)){if(Number.isNaN(l))return"";J(t.precision)||(l=l.toFixed(t.precision))}return l}),T=(l,a)=>{if(J(a)&&(a=le.value),a===0)return Math.round(l);let o=String(l);const c=o.indexOf(".");if(c===-1||!o.replace(".","").split("")[c+a])return l;const D=o.length;return o.charAt(D-1)==="5"&&(o=`${o.slice(0,Math.max(0,D-1))}6`),Number.parseFloat(Number(o).toFixed(a))},Y=l=>{if($(l))return 0;const a=l.toString(),o=a.indexOf(".");let c=0;return o!==-1&&(c=a.length-o-1),c},j=(l,a=1)=>E(l)?T(l+t.step*a):i.currentValue,A=()=>{if(t.readonly||S.value||G.value)return;const l=Number(P.value)||0,a=j(l);F(a),p(X,i.currentValue)},U=()=>{if(t.readonly||S.value||C.value)return;const l=Number(P.value)||0,a=j(l,-1);F(a),p(X,i.currentValue)},W=(l,a)=>{const{max:o,min:c,step:f,precision:V,stepStrictly:D,valueOnClear:d}=t;o<c&&Ce("InputNumber","min should not be greater than max.");let y=Number(l);if($(l)||Number.isNaN(y))return null;if(l===""){if(d===null)return null;y=Pe(d)?{min:c,max:o}[d]:d}return D&&(y=T(Math.round(y/f)*f,V)),J(V)||(y=T(y,V)),(y>o||y<c)&&(y=y>o?o:c,a&&p(M,y)),y},F=(l,a=!0)=>{var o;const c=i.currentValue,f=W(l);if(!a){p(M,f);return}c!==f&&(i.userInput=null,p(M,f),p(de,f,c),t.validateEvent&&((o=h==null?void 0:h.validate)==null||o.call(h,"change").catch(V=>ue())),i.currentValue=f)},Z=l=>{i.userInput=l;const a=l===""?null:Number(l);p(X,a),F(a,!1)},g=l=>{const a=l!==""?Number(l):"";(E(a)&&!Number.isNaN(a)||l==="")&&F(a),i.userInput=null},u=()=>{var l,a;(a=(l=v.value)==null?void 0:l.focus)==null||a.call(l)},w=()=>{var l,a;(a=(l=v.value)==null?void 0:l.blur)==null||a.call(l)},N=l=>{p("focus",l)},R=l=>{var a;i.userInput=null,p("blur",l),t.validateEvent&&((a=h==null?void 0:h.validate)==null||a.call(h,"blur").catch(o=>ue()))};return Ve(()=>t.modelValue,(l,a)=>{const o=W(l,!0);i.userInput===null&&o!==a&&(i.currentValue=o)},{immediate:!0}),he(()=>{var l;const{min:a,max:o,modelValue:c}=t,f=(l=v.value)==null?void 0:l.input;if(f.setAttribute("role","spinbutton"),Number.isFinite(o)?f.setAttribute("aria-valuemax",String(o)):f.removeAttribute("aria-valuemax"),Number.isFinite(a)?f.setAttribute("aria-valuemin",String(a)):f.removeAttribute("aria-valuemin"),f.setAttribute("aria-valuenow",i.currentValue||i.currentValue===0?String(i.currentValue):""),f.setAttribute("aria-disabled",String(S.value)),!E(c)&&c!=null){let V=Number(c);Number.isNaN(V)&&(V=null),p(M,V)}}),ge(()=>{var l,a;const o=(l=v.value)==null?void 0:l.input;o==null||o.setAttribute("aria-valuenow",`${(a=i.currentValue)!=null?a:""}`)}),I({focus:u,blur:w}),(l,a)=>(_(),z("div",{class:ae([e(b).b(),e(b).m(e(H)),e(b).is("disabled",e(S)),e(b).is("without-controls",!l.controls),e(b).is("controls-right",e(B))]),onDragstart:a[1]||(a[1]=Q(()=>{},["prevent"]))},[l.controls?oe((_(),z("span",{key:0,role:"button","aria-label":e(n)("el.inputNumber.decrease"),class:ae([e(b).e("decrease"),e(b).is("disabled",e(C))]),onKeydown:K(U,["enter"])},[r(e(re),null,{default:m(()=>[e(B)?(_(),k(e(Ee),{key:0})):(_(),k(e(Ie),{key:1}))]),_:1})],42,el)),[[e(ie),U]]):O("v-if",!0),l.controls?oe((_(),z("span",{key:1,role:"button","aria-label":e(n)("el.inputNumber.increase"),class:ae([e(b).e("increase"),e(b).is("disabled",e(G))]),onKeydown:K(A,["enter"])},[r(e(re),null,{default:m(()=>[e(B)?(_(),k(e(we),{key:0})):(_(),k(e(ke),{key:1}))]),_:1})],42,ll)),[[e(ie),A]]):O("v-if",!0),r(e(pe),{id:l.id,ref_key:"input",ref:v,type:"number",step:l.step,"model-value":e(P),placeholder:l.placeholder,readonly:l.readonly,disabled:e(S),size:e(H),max:l.max,min:l.min,name:l.name,label:l.label,"validate-event":!1,onWheel:a[0]||(a[0]=Q(()=>{},["prevent"])),onKeydown:[K(Q(A,["prevent"]),["up"]),K(Q(U,["prevent"]),["down"])],onBlur:R,onFocus:N,onInput:Z,onChange:g},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var nl=Se(tl,[["__file","input-number.vue"]]);const ol=Te(nl);const rl={class:"main-body"},ul={class:"toolbar"},sl={class:"dialog-footer"},bl={__name:"Resource",setup(s){const I=ee(["folder","menu","button"]),p=te({name:""}),t=te({id:"",type:0,name:"",displayName:"",parentId:null,url:"",orderNum:0,icon:""}),{t:n,tableRef:b,dialogVisible:v,isEdit:i,formLoading:h,formRef:C,doSearch:G,doAdd:le,doEdit:B,doRemove:H,doSubmit:S,doClose:P}=We(t),T=ee([]),Y=x(()=>[{prop:"id",label:n("thead.ID")},{prop:"name",label:n("thead.name")},{prop:"displayName",label:n("thead.displayName")},{prop:"icon",label:n("thead.icon")},{prop:"type",label:n("thead.type"),formatter:g=>{const u=g.type;return Fe(Re,{type:{1:"success",2:"info"}[u]||""},()=>n(`status.${I.value[u]}`))}},{prop:"url",label:n("thead.url"),showOverflowTooltip:!0},{prop:"orderNum",label:n("thead.orderNum")}]),j=ee({name:[{required:!0,message:n("form.nameRequired"),trigger:"blur"}],displayName:[{required:!0,message:n("form.displayNameRequired"),trigger:"blur"}],url:[{required:!0,message:n("form.urlRequired"),trigger:"blur"}]}),A=()=>{He().then(g=>{T.value=g.data})};function U(){A(),le()}function W(g){A(),B(g)}function F(g,u){H(Oe,g,u)}function Z(){S({save:Ye,update:je})}return(g,u)=>{const w=pe,N=ze,R=Ue,l=$e,a=De,o=Le,c=Me,f=Ke,V=ol,D=qe;return _(),z("div",rl,[se("div",ul,[r(l,{inline:!0,model:e(p)},{default:m(()=>[r(N,null,{default:m(()=>[r(w,{modelValue:e(p).name,"onUpdate:modelValue":u[0]||(u[0]=d=>e(p).name=d),placeholder:e(n)("thead.name")},null,8,["modelValue","placeholder"])]),_:1}),r(N,null,{default:m(()=>[r(R,{icon:"search",type:"primary",onClick:e(G)},{default:m(()=>[q(L(e(n)("action.search")),1)]),_:1},8,["onClick"])]),_:1}),r(N,null,{default:m(()=>[r(R,{icon:"plus",type:"primary",onClick:U},{default:m(()=>[q(L(e(n)("action.add")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),r(a,{rowKey:"id",ref_key:"tableRef",ref:b,"get-page":e(Ge),columns:e(Y),filters:e(p),showBatchDelete:!1,showPagination:!1,onHandleEdit:W,onHandleDelete:F},null,8,["get-page","columns","filters"]),r(D,{title:e(i)?e(n)("action.edit"):e(n)("action.add"),width:"40%",draggable:"",modelValue:e(v),"onUpdate:modelValue":u[8]||(u[8]=d=>Ae(v)?v.value=d:null),"close-on-click-modal":!1,onClose:e(P)},{footer:m(()=>[se("span",sl,[r(R,{onClick:e(P)},{default:m(()=>[q(L(e(n)("action.cancel")),1)]),_:1},8,["onClick"]),r(R,{type:"primary",onClick:Z},{default:m(()=>[q(L(e(n)("action.confirm")),1)]),_:1})])]),default:m(()=>[r(l,{model:e(t),rules:e(j),ref_key:"formRef",ref:C,onKeyup:K(Z,["enter"]),"label-width":"80px"},{default:m(()=>[r(N,{label:e(n)("thead.type"),prop:"type"},{default:m(()=>[r(c,{modelValue:e(t).type,"onUpdate:modelValue":u[1]||(u[1]=d=>e(t).type=d),disabled:e(i)},{default:m(()=>[(_(!0),z(xe,null,Be(e(I),(d,y)=>(_(),k(o,{label:y,key:y},{default:m(()=>[q(L(e(n)(`status.${d}`)),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),r(N,{label:e(n)("thead.name"),prop:"name"},{default:m(()=>[r(w,{modelValue:e(t).name,"onUpdate:modelValue":u[2]||(u[2]=d=>e(t).name=d),placeholder:e(n)("form.nameRequired")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(N,{label:e(n)("thead.displayName"),prop:"displayName"},{default:m(()=>[r(w,{modelValue:e(t).displayName,"onUpdate:modelValue":u[3]||(u[3]=d=>e(t).displayName=d),placeholder:e(n)("form.displayNameRequired")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(t).type!==2?(_(),k(N,{key:0,label:e(n)("thead.icon")},{default:m(()=>[r(w,{modelValue:e(t).icon,"onUpdate:modelValue":u[4]||(u[4]=d=>e(t).icon=d),placeholder:e(n)("thead.icon")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0),r(N,{label:e(n)("form.parent")},{default:m(()=>[r(f,{modelValue:e(t).parentId,"onUpdate:modelValue":u[5]||(u[5]=d=>e(t).parentId=d),props:{label:"displayName",value:"id",checkStrictly:!0,emitPath:!1},options:e(T),class:"w100p"},null,8,["modelValue","options"])]),_:1},8,["label"]),e(t).type===1?(_(),k(N,{key:1,label:e(n)("thead.url"),prop:e(t).type===1?"url":""},{default:m(()=>[r(w,{modelValue:e(t).url,"onUpdate:modelValue":u[6]||(u[6]=d=>e(t).url=d),placeholder:e(n)("thead.url")},null,8,["modelValue","placeholder"])]),_:1},8,["label","prop"])):O("",!0),e(t).type!==2?(_(),k(N,{key:2,label:e(n)("thead.orderNum"),prop:e(t).type!==2?"orderNum":""},{default:m(()=>[r(V,{modelValue:e(t).orderNum,"onUpdate:modelValue":u[7]||(u[7]=d=>e(t).orderNum=d),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1},8,["label","prop"])):O("",!0)]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])])}}};export{bl as default};
